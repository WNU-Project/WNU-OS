// WNU OS VERSION OF FASTFETCH
#include <windows.h> // NEEDED TO GET WINDOWS VERSION
#include <stdio.h>   // For printf

// Ensure ENABLE_VIRTUAL_TERMINAL_PROCESSING is defined for older Windows SDKs
#ifndef ENABLE_VIRTUAL_TERMINAL_PROCESSING
#define ENABLE_VIRTUAL_TERMINAL_PROCESSING 0x0004
#endif

int fastfetch() {
    // Enable ANSI colors in console
    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
    if (hStdout != INVALID_HANDLE_VALUE) {
        DWORD mode;
        GetConsoleMode(hStdout, &mode);
        SetConsoleMode(hStdout, mode | ENABLE_VIRTUAL_TERMINAL_PROCESSING);
    }

    OSVERSIONINFOEX osvi;
    SYSTEM_INFO si;
    ZeroMemory(&si, sizeof(SYSTEM_INFO));
    ZeroMemory(&osvi, sizeof(OSVERSIONINFOEX));
    osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);

    if (!GetVersionEx((OSVERSIONINFO*)&osvi)) {
        printf("Error getting OS version: %lu\n", GetLastError());
        return 1;
    }
    GetSystemInfo(&si);

    char* windows_version_logo = NULL;
    if (osvi.dwMajorVersion == 10 && osvi.dwMinorVersion == 0 && osvi.dwBuildNumber >= 22000) {
        // Win11-specific logo: Split into adjacent strings for multi-line
        windows_version_logo = "\033[34m........ .... .... .... .... .... .... .... .... .... .... .... ..... ... .... ..... ... .... .... .\n"
                               "....................................................................................................\n"
                               "....................................................................................................\n"
                               "........ .... .... .... .... .... .... .... .... .... .... .... ..... ... .... ..... ... .... .... .\n"
                               "....................................................................................................\n"
                               "....................................................................................................\n"
                               "........ ..:------------------------------------....------------------------------------..... .... .\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               "...........-+**********************************+...:+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........:+***********************************...:+***********************************-...........\n"
                               "...........:+***********************************...:+***********************************-...........\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "............:--::---::---::---:::--::---::---:::....:--::---::---::---:::--::---::---::::...........\n"
                               "....................................................................................................\n"
                               "........ ....................................... ............................................ .... .\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               "...........:+***********************************...:+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               "...........-************************************...:+***********************************-...........\n"
                               "...........-************************************...:+***********************************-...........\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "...........-***********************************+...:+***********************************-...........\n"
                               "...........:+***********************************:...+***********************************-...........\n"
                               ". .... ....:+***********************************:...+***********************************-.. .... ...\n"
                               "........ ..-***********************************+...:+***********************************-.... .... .\n"
                               "............------------------------------------....------------------------------------:...........\n"
                               "....................................................................................................\n"
                               "....................................................................................................\n"
                               ". .... ........ ..... ... .......... ... ..... .... .... .... .... ......... .... ... ..... .... ...\n"
                               "....................................................................................................\n"
                               "....................................................................................................\n"
                               ". .... ........ ..... ... .......... ... ..... .... .... .... .... ......... .... ... ..... .... ...\033[0m";
    }

    if (osvi.dwMajorVersion == 10 && osvi.dwMinorVersion == 0 && osvi.dwBuildNumber >= 10240) {
        // Win10 2004+ logo
        windows_version_logo = "\033[34m                                                                                          .:-==+***:
                                                                           ...::-==++**************:
                                                             ......:-=+****************************:
                                                    ..:-=+*****************************************:
                                      ....   -+****************************************************:
                       .....::-==+******=.   =*****************************************************:
             ..::=+*********************=.   =*****************************************************:
.::-=+++********************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
:::::::::::::::::::::.....................   .......................................................
                                                                                                    
:::::::::::::::::::::::::::...............   .......................................................
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
****************************************=.   =*****************************************************:
..:--=++********************************=.   =*****************************************************:
"             ...:-=+********************=.   =*****************************************************:"
"                       .....::-==+******=.   =*****************************************************:"
"                                       ...   -++***************************************************:"
"                                                     ...:-=+***************************************:"
"                                                               .....::-=+**************************:"
"                                                                             ...::-==++************:"
                                                                                             .:-==+:";}
    // Print logo (Win11 or fallback)
    if (windows_version_logo) {
        printf("%s\n", windows_version_logo);
    }
    printf("WNU OS Version: 1.0.1\n");
    printf("Windows Version: %d.%d Build %d\n", osvi.dwMajorVersion, osvi.dwMinorVersion, osvi.dwBuildNumber);
    printf("System Architecture: %s\n", (si.wProcessorArchitecture == PROCESSOR_ARCHITECTURE_AMD64) ? "x64" : "x86");
    
    return 0;
}